---
- name: Prepare
  hosts: all
  {% raw -%}
  tasks:
    - name: dump vars
      block:
        - name: create dump directory
          file:
            path: dump_vars
            state: directory
          changed_when: false
        - name: dump host vars
          blockinfile:
            path: "dump_vars/{{ inventory_hostname }}.yml"
            create: true
            block: "{{ vars | to_nice_yaml }}"
          changed_when: false
      connection: local
      become: false
{% endraw -%}
